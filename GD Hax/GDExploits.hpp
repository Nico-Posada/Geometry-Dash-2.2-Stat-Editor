#pragma once
#include <cstdint>

#include "Macros.hpp"
#include "memory.hpp"

namespace stat_edits
{
	enum StatType : int
	{
		INVALID = -1,
		NONE,
		JUMPS,
		ATTEMPTS,
		COMPLETED_LEVELS,
		COMPLETED_ONLINE_LEVELS,
		DEMONS,
		STARS,
		MAP_PACKS_COMPLETED,
		COINS,
		PLAYERS_DESTROYED,
		LIKED_DISLIKED_LEVELS,
		RATED_LEVELS,
		USERCOINS,
		DIAMONDS,
		ORBS,
		COMPLETED_DAILY_LEVELS,
		SHADOW_SHARDS,
		POISON_SHARDS,
		FIRE_SHARDS,
		ICE_SHARDS,
		LAVA_SHARDS,
		BASEMENT_KEYS,
		TOTAL_ORBS_COLLECTED,
		/* too lazy to add the new ones to this list, theyre in the strings */
		TOTAL_COUNT = 31
	};

	static LPCSTR stat_types[] = {
		"TOTAL JUMPS",
		"TOTAL ATTEMPTS",
		"COMPLETED LEVELS",
		"COMPLETED ONLINE LEVELS",
		"DEMONS",
		"STARS",
		"MAP PACKS COMPLETED",
		"COINS",
		"PLAYERS DESTROYED",
		"LIKED/DISLIKED LEVELS",
		"RATED LEVELS",
		"USER COINS",
		"DIAMONDS",
		"ORBS",
		"COMPLETED DAILY LEVELS",
		"SHADOW SHARDS",
		"POISON SHARDS",
		"FIRE SHARDS",
		"ICE SHARDS",
		"LAVA SHARDS",
		"BASEMENT KEYS",
		"TOTAL ORBS COLLECTED",
		"EARTH SHARDS",
		"BLOOD SHARDS",
		"METAL SHARDS",
		"LIGHT SHARDS",
		"SOUL SHARDS",
		"MOONS",
		"DOUBLE DIAMONDS",
		"COMPLETED GAUNTLETS",
		"COLLECTED LIST REWARDS"
	};

	//struct StatInfo
	//{
	//	StatInfo* next[3];
	//	STRUCT_PAD(1);
	//	bool should_end;
	//	STRUCT_PAD(2);
	//	int num;
	//	int value;
	//};

	struct StatLinkedList {
		void* end;
		StatLinkedList* next;
		StatType stat;
		uint32_t value;
	};

	struct StatInfo {
		void* unk1;
		void* list_end;
		uint64_t list_length;
		StatLinkedList** stat_table;
		void* unk5;
		void* unk6;
		uint64_t hash_mask;
		void* hash_info_unk;
	};

	constexpr auto offset = offsetof(StatLinkedList, value);

	//int* get_stat_addr(driver& game, StatInfo* stat_info_addr, StatType stat);
	uint64_t hash_number(driver& game, StatInfo* instance, uint8_t* number);
	StatLinkedList* get_stat_addr(driver& game, StatInfo* stat_info_addr, StatType stat);
}
