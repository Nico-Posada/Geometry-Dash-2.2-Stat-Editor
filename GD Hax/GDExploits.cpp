#include "GDExploits.hpp"

// basically just recreated the code from GeometryDash.exe+0F3580
int* stat_edits::get_stat_addr(driver& game, StatInfo* stat_info_addr, StatType stat)
{
    StatInfo* v2 = stat_info_addr;
    auto v3 = game.read<StatInfo*>(&v2->next2);

    bool pass = false;
    while (!game.read<bool>(&v3->should_end))
    {
        if (game.read<int>(&v3->num) >= stat)
        {
            v2 = v3;
            v3 = game.read<StatInfo*>(&v3->next1);
            pass = true;
        }
        else
        {
            v3 = game.read<StatInfo*>(&v3->next3);
        }
    }

    if (pass && stat >= game.read<int>(&v2->num))
        return &v2->value;
    
    return nullptr;
}